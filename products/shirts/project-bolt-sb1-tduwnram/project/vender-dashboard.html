<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vendor Dashboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Vendor Dashboard</h1>
    <div id="product-list">
        <!-- Product list will be populated here -->
    </div>
    <button onclick="openAddProductModal()">Add Product</button>

    <!-- Add Product Modal -->
    <div id="add-product-modal" class="modal">
        <div class="modal-content">
            <h2>Add Product</h2>
            <form id="add-product-form">
                <label for="product-name">Product Name:</label>
                <input type="text" id="product-name" required>
                
                <label for="product-price">Price:</label>
                <input type="number" id="product-price" required>
                
                <label for="product-image">Image URL:</label>
                <input type="text" id="product-image" required>
                
                <label for="product-sizes">Sizes (comma separated):</label>
                <input type="text" id="product-sizes" placeholder="S,M,L,XL" required>
                
                <label for="product-colors">Colors (comma separated):</label>
                <input type="text" id="product-colors" placeholder="Red,Blue,Green" required>
                
                <button type="submit">Add Product</button>
              </form>
            <button onclick="closeAddProductModal()">Close</button>
        </div>
    </div>

    <script src="main.js"></script>
    <script>
        // Function to open the add product modal
        window.openAddProductModal = () => {
            document.getElementById('add-product-modal').style.display = 'block';
        };

        // Function to close the add product modal
        window.closeAddProductModal = () => {
            document.getElementById('add-product-modal').style.display = 'none';
        };

        // Function to handle form submission
        document.getElementById('add-product-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const productName = document.getElementById('product-name').value;
            const productPrice = document.getElementById('product-price').value;
            const productImage = document.getElementById('product-image').value;

            try {
                const response = await fetch("/api/products/add", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        name: productName,
                        price: productPrice,
                        image: productImage
                    }),
                });

                const result = await response.json();
                console.log("Product Added:", result);
                closeAddProductModal();
                loadProducts(); // Reload the product list
            } catch (error) {
                console.error("Error adding product:", error);
            }
        });

        // Function to load products
        async function loadProducts() {
            try {
                const response = await fetch("/api/products");
                const products = await response.json();
                const productList = document.getElementById('product-list');
                productList.innerHTML = products.map(product => `
                    <div class="product-item">
                        <h3>${product.name}</h3>
                        <p>Price: Rs.${product.price}</p>
                        <img src="${product.image}" alt="${product.name}" style="width: 100px;">
                        <button onclick="deleteProduct(${product.id})">Delete</button>
                    </div>
                `).join('');
            } catch (error) {
                console.error("Error loading products:", error);
            }
        }

        // Function to delete a product
        window.deleteProduct = async (productId) => {
            try {
                await fetch(`/api/products/delete/${productId}`, {
                    method: "DELETE",
                });
                loadProducts(); // Reload the product list
            } catch (error) {
                console.error("Error deleting product:", error);
            }
        };

        // Load products on page load
        document.addEventListener("DOMContentLoaded", loadProducts);
    </script>
</script>
<script>
    function updateCartCount() {
        Promise.all([fetch("/api/cart"), fetch("/api/cartp")])
            .then(async ([regularRes, personalizedRes]) => {
                const regularItems = await regularRes.json();
                const personalizedItems = await personalizedRes.json();
                const totalItems = [...regularItems, ...personalizedItems]
                    .reduce((sum, item) => sum + item.quantity, 0);
                document.getElementById("cart-count").textContent = totalItems;
            })
            .catch(() => document.getElementById("cart-count").textContent = "0");
    }

    document.addEventListener("DOMContentLoaded", updateCartCount);
</script>
</body>
</html>
<script>
document.addEventListener("DOMContentLoaded", function() {
  const minusBtn = document.querySelector('.btn-minus');
  const plusBtn = document.querySelector('.btn-plus');
  const quantityInput = document.getElementById('quantity');

  minusBtn.addEventListener('click', function(e) {
    e.preventDefault();
    let currentValue = parseInt(quantityInput.value) || 1;
    if (currentValue > 1) {
      quantityInput.value = currentValue - 1;
    }
  });

  plusBtn.addEventListener('click', function(e) {
    e.preventDefault();
    let currentValue = parseInt(quantityInput.value) || 1;
    quantityInput.value = currentValue + 1;
  });
});
</script>
